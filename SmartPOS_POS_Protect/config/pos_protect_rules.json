{
    "$schema": "./schema/pos_protect_policies.schema.json",
    "rules": [
        {
            "name": "PRINT_SPOOLER_STUCK",
            "match": {
                "any": [
                    {
                        "type": "eventlog",
                        "provider": "Service Control Manager",
                        "event_id": 7031
                    },
                    {
                        "type": "eventlog",
                        "provider": "Service Control Manager",
                        "event_id": 7034
                    },
                    {
                        "type": "eventlog",
                        "provider": "Spooler",
                        "level": "Warning"
                    }
                ],
                "window_sec": 900
            },
            "issue_code": "PRINT_SPOOLER_STUCK",
            "severity": "medium",
            "dedup_key": "svc:Spooler",
            "repeat_thresholds": [
                1,
                3,
                5
            ],
            "plan": [
                {
                    "action": "restart_service",
                    "args": {
                        "name": "Spooler"
                    },
                    "timeout_sec": 15,
                    "retries": 1
                },
                {
                    "action": "clear_print_queue",
                    "args": {},
                    "timeout_sec": 20,
                    "retries": 0
                }
            ]
        },
        {
            "name": "DISK_IO_WARN",
            "match": {
                "any": [
                    {
                        "type": "eventlog",
                        "provider": "Disk",
                        "event_id": 51
                    },
                    {
                        "type": "eventlog",
                        "provider": "Disk",
                        "event_id": 153
                    },
                    {
                        "type": "eventlog",
                        "provider": "storahci"
                    },
                    {
                        "type": "eventlog",
                        "provider": "volmgr"
                    },
                    {
                        "type": "eventlog",
                        "provider": "Ntfs"
                    }
                ],
                "window_sec": 3600
            },
            "issue_code": "DISK_IO_WARN",
            "severity": "high",
            "dedup_key": "disk:warnings",
            "repeat_thresholds": [
                1,
                2,
                4
            ],
            "plan": [
                {
                    "action": "link_smart",
                    "args": {},
                    "timeout_sec": 10,
                    "retries": 0
                },
                {
                    "action": "plan_chkdsk",
                    "args": {
                        "volume": "C:"
                    },
                    "timeout_sec": 10,
                    "retries": 0
                }
            ]
        },
        {
            "name": "SIMPLE_WER_CRASH",
            "match": {
                "any": [
                    {
                        "type": "wer"
                    }
                ],
                "window_sec": 1800
            },
            "issue_code": "SIMPLE_WER_CRASH",
            "severity": "medium",
            "dedup_key": "wer:simple",
            "repeat_thresholds": [
                1
            ],
            "plan": [
                {
                    "action": "collect_wer_bundle",
                    "args": {
                        "include_report_queue": false
                    },
                    "timeout_sec": 20,
                    "retries": 0
                }
            ]
        },
        {
            "name": "LIVE_KERNEL_EVENT",
            "match": {
                "any": [
                    {
                        "type": "wer",
                        "bucket": "LiveKernelEvent_141"
                    },
                    {
                        "type": "wer",
                        "bucket_regex": "LiveKernelEvent_.*"
                    }
                ],
                "window_sec": 7200
            },
            "issue_code": "LIVE_KERNEL_EVENT",
            "severity": "critical",
            "dedup_key": "wer:lke",
            "repeat_thresholds": [
                1,
                1,
                1
            ],
            "plan": [
                {
                    "action": "collect_wer_bundle",
                    "args": {
                        "include_report_queue": false
                    },
                    "timeout_sec": 30,
                    "retries": 0
                }
            ]
        }
    ]
}